/**
 * Pentest Mock Data - Campaigns
 *
 * Mock data for penetration testing campaigns
 */

import type { PentestCampaign } from "../../types";
import { mockTeamMembers } from "./team-members";

// ============================================
// Mock Campaigns
// ============================================

export const mockPentestCampaigns: PentestCampaign[] = [
  {
    id: "camp-001",
    name: "Q4 2024 External Penetration Test",
    description:
      "Comprehensive external penetration test targeting internet-facing assets including web applications, APIs, and network infrastructure.",
    status: "in_progress",
    type: "external",
    priority: "high",
    startDate: "2024-10-01",
    endDate: "2024-10-31",
    clientName: "Acme Corporation",
    clientContact: "security@acme.com",
    scope: [
      { id: "s-001", type: "domain", value: "*.acme.com", inScope: true },
      { id: "s-002", type: "domain", value: "*.acme-internal.com", inScope: false, notes: "Internal only" },
      { id: "s-003", type: "ip", value: "203.0.113.0/24", inScope: true },
      { id: "s-004", type: "url", value: "https://app.acme.com", inScope: true },
      { id: "s-005", type: "url", value: "https://api.acme.com", inScope: true },
    ],
    rulesOfEngagement: {
      testingHours: "Monday-Friday, 9:00 AM - 6:00 PM EST",
      allowedMethods: ["Port scanning", "Vulnerability scanning", "Web app testing", "API testing"],
      restrictedMethods: ["DoS/DDoS", "Social engineering", "Physical access"],
      emergencyContact: "+1-555-0123",
      communicationChannel: "Slack #security-pentest",
      escalationProcedure: "Contact security team lead for critical findings",
      dataHandling: "All data must be encrypted and deleted after engagement",
    },
    team: [mockTeamMembers[0], mockTeamMembers[1], mockTeamMembers[3]],
    objectives: [
      "Identify vulnerabilities in external-facing web applications",
      "Test API security controls",
      "Evaluate network perimeter security",
      "Assess authentication and authorization mechanisms",
    ],
    methodology: "OWASP Testing Guide v4.2, PTES",
    findingsCount: {
      critical: 2,
      high: 5,
      medium: 12,
      low: 8,
      info: 15,
    },
    progress: 65,
    tags: ["external", "web", "api", "q4-2024"],
    createdAt: "2024-09-15T10:00:00Z",
    updatedAt: "2024-10-20T14:30:00Z",
    createdBy: "tm-001",
  },
  {
    id: "camp-002",
    name: "Mobile Banking App Security Assessment",
    description:
      "Security assessment of the iOS and Android mobile banking applications, including API testing and runtime analysis.",
    status: "in_progress",
    type: "mobile",
    priority: "critical",
    startDate: "2024-10-15",
    endDate: "2024-11-15",
    clientName: "SecureBank Ltd",
    clientContact: "appsec@securebank.com",
    scope: [
      { id: "s-006", type: "application", value: "SecureBank iOS App v3.2", inScope: true },
      { id: "s-007", type: "application", value: "SecureBank Android App v3.2", inScope: true },
      { id: "s-008", type: "url", value: "https://api.securebank.com/mobile/*", inScope: true },
    ],
    rulesOfEngagement: {
      testingHours: "24/7 in staging environment",
      allowedMethods: ["Static analysis", "Dynamic analysis", "API testing", "Runtime manipulation"],
      restrictedMethods: ["Production testing", "Customer data access"],
      emergencyContact: "+1-555-0456",
      communicationChannel: "Microsoft Teams - AppSec Channel",
      escalationProcedure: "Immediate notification for authentication bypasses",
      dataHandling: "Use only test accounts provided",
    },
    team: [mockTeamMembers[2], mockTeamMembers[4]],
    objectives: [
      "Analyze application binary for security weaknesses",
      "Test authentication and session management",
      "Evaluate data storage security",
      "Assess API security and encryption",
    ],
    methodology: "OWASP Mobile Security Testing Guide (MSTG)",
    findingsCount: {
      critical: 1,
      high: 3,
      medium: 7,
      low: 4,
      info: 10,
    },
    progress: 40,
    tags: ["mobile", "ios", "android", "banking", "fintech"],
    createdAt: "2024-10-01T09:00:00Z",
    updatedAt: "2024-10-22T11:00:00Z",
    createdBy: "tm-002",
  },
  {
    id: "camp-003",
    name: "Internal Network Penetration Test",
    description:
      "Internal penetration test simulating an insider threat or compromised employee workstation scenario.",
    status: "planning",
    type: "internal",
    priority: "high",
    startDate: "2024-11-01",
    endDate: "2024-11-30",
    clientName: "TechCorp Industries",
    clientContact: "it-security@techcorp.io",
    scope: [
      { id: "s-009", type: "cidr", value: "10.0.0.0/8", inScope: true },
      { id: "s-010", type: "cidr", value: "172.16.0.0/12", inScope: true },
      { id: "s-011", type: "domain", value: "*.techcorp.local", inScope: true },
      { id: "s-012", type: "ip", value: "10.0.0.1", inScope: false, notes: "Domain Controller - Read Only" },
    ],
    team: [mockTeamMembers[0], mockTeamMembers[2], mockTeamMembers[4]],
    objectives: [
      "Test network segmentation",
      "Attempt privilege escalation",
      "Evaluate Active Directory security",
      "Assess internal application security",
    ],
    methodology: "PTES, MITRE ATT&CK Framework",
    findingsCount: {
      critical: 0,
      high: 0,
      medium: 0,
      low: 0,
      info: 0,
    },
    progress: 0,
    tags: ["internal", "network", "ad", "q4-2024"],
    createdAt: "2024-10-15T14:00:00Z",
    updatedAt: "2024-10-15T14:00:00Z",
    createdBy: "tm-001",
  },
  {
    id: "camp-004",
    name: "Cloud Infrastructure Security Review",
    description:
      "Comprehensive security assessment of AWS cloud infrastructure including IAM, S3, EC2, and VPC configurations.",
    status: "completed",
    type: "cloud",
    priority: "high",
    startDate: "2024-08-01",
    endDate: "2024-08-31",
    clientName: "CloudFirst Solutions",
    clientContact: "devops@cloudfirst.io",
    scope: [
      { id: "s-013", type: "application", value: "AWS Account: 123456789012", inScope: true },
      { id: "s-014", type: "application", value: "AWS Region: us-east-1", inScope: true },
      { id: "s-015", type: "application", value: "AWS Region: eu-west-1", inScope: true },
    ],
    rulesOfEngagement: {
      testingHours: "Business hours only",
      allowedMethods: ["Configuration review", "IAM analysis", "Read-only API calls"],
      restrictedMethods: ["Resource modification", "Data deletion", "Production impact"],
      emergencyContact: "+1-555-0789",
      communicationChannel: "Slack #cloud-security",
      escalationProcedure: "Contact DevOps lead for any access issues",
      dataHandling: "No customer data extraction",
    },
    team: [mockTeamMembers[1], mockTeamMembers[3]],
    objectives: [
      "Review IAM policies and permissions",
      "Assess S3 bucket security",
      "Evaluate network security groups",
      "Check encryption at rest and in transit",
    ],
    methodology: "CIS AWS Foundations Benchmark",
    findingsCount: {
      critical: 1,
      high: 4,
      medium: 8,
      low: 12,
      info: 20,
    },
    progress: 100,
    tags: ["cloud", "aws", "infrastructure", "completed"],
    createdAt: "2024-07-15T10:00:00Z",
    updatedAt: "2024-09-05T16:00:00Z",
    createdBy: "tm-003",
  },
  {
    id: "camp-005",
    name: "E-commerce Platform Web Application Test",
    description:
      "Comprehensive web application penetration test of the e-commerce platform including payment processing and user authentication.",
    status: "in_progress",
    type: "web_app",
    priority: "critical",
    startDate: "2024-10-10",
    endDate: "2024-11-10",
    clientName: "ShopMax Inc",
    clientContact: "security@shopmax.com",
    scope: [
      { id: "s-016", type: "url", value: "https://www.shopmax.com", inScope: true },
      { id: "s-017", type: "url", value: "https://checkout.shopmax.com", inScope: true },
      { id: "s-018", type: "url", value: "https://api.shopmax.com", inScope: true },
      { id: "s-019", type: "url", value: "https://admin.shopmax.com", inScope: true },
    ],
    rulesOfEngagement: {
      testingHours: "9 AM - 9 PM EST",
      allowedMethods: ["OWASP Top 10 testing", "Business logic testing", "API fuzzing"],
      restrictedMethods: ["Actual payment transactions", "Customer PII access", "Production database writes"],
      emergencyContact: "+1-555-0321",
      communicationChannel: "Email: security@shopmax.com",
      escalationProcedure: "Pause testing and notify for payment-related critical findings",
      dataHandling: "Use test credit cards only",
    },
    team: [mockTeamMembers[0], mockTeamMembers[1], mockTeamMembers[2], mockTeamMembers[3]],
    objectives: [
      "Test authentication and session management",
      "Evaluate payment processing security",
      "Assess input validation and injection attacks",
      "Review access control mechanisms",
      "Test file upload functionality",
    ],
    methodology: "OWASP Testing Guide, PCI-DSS Requirements",
    findingsCount: {
      critical: 3,
      high: 7,
      medium: 15,
      low: 10,
      info: 8,
    },
    progress: 75,
    tags: ["web", "ecommerce", "pci", "payments"],
    createdAt: "2024-09-25T11:00:00Z",
    updatedAt: "2024-10-23T09:30:00Z",
    createdBy: "tm-001",
  },
  {
    id: "camp-006",
    name: "API Security Assessment - Healthcare Platform",
    description:
      "Security assessment of RESTful and GraphQL APIs for a healthcare data platform handling PHI.",
    status: "completed",
    type: "api",
    priority: "critical",
    startDate: "2024-09-01",
    endDate: "2024-09-30",
    clientName: "HealthData Systems",
    clientContact: "compliance@healthdata.io",
    scope: [
      { id: "s-020", type: "url", value: "https://api.healthdata.io/v1/*", inScope: true },
      { id: "s-021", type: "url", value: "https://api.healthdata.io/graphql", inScope: true },
      { id: "s-022", type: "url", value: "https://api.healthdata.io/v2/*", inScope: false, notes: "Under development" },
    ],
    rulesOfEngagement: {
      testingHours: "Staging environment 24/7",
      allowedMethods: ["API fuzzing", "Authentication testing", "Authorization testing", "Rate limiting tests"],
      restrictedMethods: ["PHI access", "Production testing", "DoS attacks"],
      emergencyContact: "+1-555-0654",
      communicationChannel: "Secure portal",
      escalationProcedure: "Immediate notification for data exposure vulnerabilities",
      dataHandling: "HIPAA compliant - synthetic data only",
    },
    team: [mockTeamMembers[2], mockTeamMembers[4]],
    objectives: [
      "Test API authentication mechanisms (OAuth 2.0, JWT)",
      "Evaluate authorization and access controls",
      "Assess data validation and injection attacks",
      "Review rate limiting and throttling",
      "Test for BOLA/IDOR vulnerabilities",
    ],
    methodology: "OWASP API Security Top 10",
    findingsCount: {
      critical: 2,
      high: 6,
      medium: 9,
      low: 5,
      info: 12,
    },
    progress: 100,
    tags: ["api", "healthcare", "hipaa", "graphql"],
    createdAt: "2024-08-15T08:00:00Z",
    updatedAt: "2024-10-02T10:00:00Z",
    createdBy: "tm-002",
  },
  {
    id: "camp-007",
    name: "Social Engineering Assessment",
    description:
      "Simulated phishing campaign and social engineering assessment to evaluate employee security awareness.",
    status: "on_hold",
    type: "social_engineering",
    priority: "medium",
    startDate: "2024-11-15",
    endDate: "2024-12-15",
    clientName: "GlobalTech Corp",
    clientContact: "hr-security@globaltech.com",
    scope: [
      { id: "s-023", type: "domain", value: "globaltech.com (email domain)", inScope: true },
      { id: "s-024", type: "application", value: "Employee email system", inScope: true },
    ],
    rulesOfEngagement: {
      testingHours: "Business hours",
      allowedMethods: ["Phishing emails", "Pretexting calls", "USB drop (approved areas)"],
      restrictedMethods: ["Physical intrusion", "Executive targeting without approval", "Credential harvesting of real creds"],
      emergencyContact: "+1-555-0987",
      communicationChannel: "HR Security Team",
      escalationProcedure: "Weekly status updates, immediate for policy violations",
      dataHandling: "No actual credential storage",
    },
    team: [mockTeamMembers[0], mockTeamMembers[5]],
    objectives: [
      "Measure phishing click rates",
      "Test credential submission behavior",
      "Evaluate reporting procedures",
      "Assess security awareness training effectiveness",
    ],
    methodology: "Custom methodology based on NIST guidelines",
    findingsCount: {
      critical: 0,
      high: 0,
      medium: 0,
      low: 0,
      info: 0,
    },
    progress: 0,
    tags: ["social-engineering", "phishing", "awareness", "on-hold"],
    createdAt: "2024-10-10T15:00:00Z",
    updatedAt: "2024-10-18T09:00:00Z",
    createdBy: "tm-001",
  },
  {
    id: "camp-008",
    name: "Wireless Network Security Assessment",
    description:
      "Assessment of corporate wireless network infrastructure including WPA3, guest networks, and rogue AP detection.",
    status: "completed",
    type: "wireless",
    priority: "medium",
    startDate: "2024-07-01",
    endDate: "2024-07-15",
    clientName: "OfficeSpace Inc",
    clientContact: "network-ops@officespace.com",
    scope: [
      { id: "s-025", type: "application", value: "Corporate SSID: OfficeSpace-Corp", inScope: true },
      { id: "s-026", type: "application", value: "Guest SSID: OfficeSpace-Guest", inScope: true },
      { id: "s-027", type: "application", value: "IoT SSID: OfficeSpace-IoT", inScope: true },
    ],
    team: [mockTeamMembers[4]],
    objectives: [
      "Test WPA3 implementation",
      "Evaluate network segmentation",
      "Identify rogue access points",
      "Assess guest network isolation",
    ],
    methodology: "Wireless Security Assessment Framework",
    findingsCount: {
      critical: 0,
      high: 2,
      medium: 4,
      low: 6,
      info: 8,
    },
    progress: 100,
    tags: ["wireless", "network", "wifi", "completed"],
    createdAt: "2024-06-20T10:00:00Z",
    updatedAt: "2024-07-20T14:00:00Z",
    createdBy: "tm-004",
  },
  {
    id: "camp-009",
    name: "Physical Security Assessment - HQ Building",
    description:
      "Physical penetration test of corporate headquarters including access control, surveillance, and social engineering at entry points.",
    status: "planning",
    type: "physical",
    priority: "low",
    startDate: "2024-12-01",
    endDate: "2024-12-10",
    clientName: "SecureCorp HQ",
    clientContact: "facilities@securecorp.com",
    scope: [
      { id: "s-028", type: "application", value: "Main entrance and lobby", inScope: true },
      { id: "s-029", type: "application", value: "Parking garage", inScope: true },
      { id: "s-030", type: "application", value: "Server room", inScope: true, notes: "Escort required" },
      { id: "s-031", type: "application", value: "Executive floor", inScope: false },
    ],
    team: [mockTeamMembers[0], mockTeamMembers[5]],
    objectives: [
      "Test badge access controls",
      "Evaluate tailgating vulnerability",
      "Assess visitor management process",
      "Test emergency exit procedures",
    ],
    methodology: "Physical Security Assessment Guidelines",
    findingsCount: {
      critical: 0,
      high: 0,
      medium: 0,
      low: 0,
      info: 0,
    },
    progress: 0,
    tags: ["physical", "access-control", "hq"],
    createdAt: "2024-10-20T16:00:00Z",
    updatedAt: "2024-10-20T16:00:00Z",
    createdBy: "tm-001",
  },
  {
    id: "camp-010",
    name: "Network Infrastructure Penetration Test",
    description:
      "Comprehensive network penetration test targeting routers, switches, firewalls, and network services.",
    status: "in_progress",
    type: "network",
    priority: "high",
    startDate: "2024-10-20",
    endDate: "2024-11-20",
    clientName: "NetSecure Industries",
    clientContact: "noc@netsecure.io",
    scope: [
      { id: "s-032", type: "cidr", value: "192.168.0.0/16", inScope: true },
      { id: "s-033", type: "ip", value: "192.168.1.1", inScope: true, notes: "Core router" },
      { id: "s-034", type: "ip", value: "192.168.1.254", inScope: true, notes: "Firewall" },
    ],
    rulesOfEngagement: {
      testingHours: "Off-peak hours: 10 PM - 6 AM",
      allowedMethods: ["Port scanning", "Service enumeration", "Vulnerability exploitation"],
      restrictedMethods: ["Network disruption", "Configuration changes", "DoS"],
      emergencyContact: "+1-555-1111",
      communicationChannel: "NOC hotline",
      escalationProcedure: "Immediate notification for network-impacting findings",
      dataHandling: "Network traffic captures encrypted",
    },
    team: [mockTeamMembers[1], mockTeamMembers[2], mockTeamMembers[4]],
    objectives: [
      "Identify vulnerable network services",
      "Test firewall rules effectiveness",
      "Evaluate VLAN segmentation",
      "Assess network monitoring capabilities",
    ],
    methodology: "PTES Network Testing",
    findingsCount: {
      critical: 1,
      high: 3,
      medium: 6,
      low: 9,
      info: 11,
    },
    progress: 35,
    tags: ["network", "infrastructure", "firewall"],
    createdAt: "2024-10-10T12:00:00Z",
    updatedAt: "2024-10-23T08:00:00Z",
    createdBy: "tm-003",
  },
];

// ============================================
// Helper Functions
// ============================================

export function getCampaigns(): PentestCampaign[] {
  return mockPentestCampaigns;
}

export function getCampaignById(id: string): PentestCampaign | undefined {
  return mockPentestCampaigns.find((campaign) => campaign.id === id);
}

export function getCampaignsByStatus(status: PentestCampaign["status"]): PentestCampaign[] {
  return mockPentestCampaigns.filter((campaign) => campaign.status === status);
}

export function getCampaignsByType(type: PentestCampaign["type"]): PentestCampaign[] {
  return mockPentestCampaigns.filter((campaign) => campaign.type === type);
}

// Stats helpers
export function getCampaignStats() {
  const campaigns = mockPentestCampaigns;
  return {
    total: campaigns.length,
    planning: campaigns.filter((c) => c.status === "planning").length,
    inProgress: campaigns.filter((c) => c.status === "in_progress").length,
    completed: campaigns.filter((c) => c.status === "completed").length,
    onHold: campaigns.filter((c) => c.status === "on_hold").length,
    cancelled: campaigns.filter((c) => c.status === "cancelled").length,
    totalFindings: campaigns.reduce(
      (acc, c) =>
        acc + c.findingsCount.critical + c.findingsCount.high + c.findingsCount.medium + c.findingsCount.low + c.findingsCount.info,
      0
    ),
    criticalFindings: campaigns.reduce((acc, c) => acc + c.findingsCount.critical, 0),
    highFindings: campaigns.reduce((acc, c) => acc + c.findingsCount.high, 0),
  };
}
